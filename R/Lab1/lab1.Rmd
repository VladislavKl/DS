---
output: word_document
---
#Лабораторный практикум c R

**Преподаватель**
```
Дорошко Ольга Валерьевна
```
**Студент**
```
Клюев Владислав Дмитриевич, 1 курс, Аналитическая логистика
```
**Вариант № 10**


# Задание 1. Управление данными в R

Скопировать файл "QC10.txt" (10 - номер варианта) из папки "DATA" в рабочую директорию (узнать путь к рабочей директории можно вызовом getwd() в консоли).   
Ввести данные из текстового файла согласно варианту (функция "read.table"). Сохранить в переменную qc (таблица данных).

```{r}
qc=read.table("QC10.txt")
```

Вывести размерность таблицы данных(dim).
```{r}
dim(qc)
```

Вывести первые 3 записи таблицы (head).
```{r}
head(qc, 3)
```

Изменить имена переменных в таблице (names) согласно:
"б"-"kit", "п"-"nbug","№изг"-"maker","№пост"-"vendor","№вд"-"bug"
"н" - последовательно проименовать как "с1", "c2","c3","c4" (порядок переменных - согласно варианту).   
Вывести часть таблицы функцией head.
```{r}
colnames(qc) = c('c1', 'c2', 'kit','nbug', 'maker', 'vendor','c3', 'c4', 'bug')
head(qc)
```

Вывести общую статистику по переменной vendor (summary из Раздела 2).  Обращаться к переменной через "$".   
```{r}
summary(qc$vendor)
```

Преобразовать vendor в переменную-фактор (c помощью as.factor, для доступа к переменной обратиться к столбцу с помощью оператора []).   
Вывести общую статистику для преобразованной переменной vendor (summary).   
```{r}
qc[,6] = as.factor(qc[,6])
summary(qc[,6])
```

Подсчитать количество изделий, у которых число дефектов больше 3 (функция sum и оператор условия).
```{r}
sum(qc$nbug > 3)
```

Вывести наблюдение, для которого количество некретических дефектов равно максимальному (оператор [] к переменной qc, функция max).  
```{r}
qc[qc$nbug == max(qc$nbug),]
```

# Задание 2. Описательная статистика и графический анализ

Присоединить таблицу данных qc к списку текущих переменных (attach). Далее обращаться к именам переменных напрямую.   
Загрузить дополнительную библиотеку (для вычисления коэффициентов асимметрии и эксцесса).   
```{r}
attach(qc)
library("e1071")
```

В данном пункте статистики и графики выводятся только для переменной c1. 

Вычислить среднее (mean) и медиану (median).   
```{r}
mean(c1)
median(c1)
```

Вычислить выборочные квартили Q1,Q2,Q3 (quantile), а также интерквартильный размах с помощью указанной функции.  
```{r}
quantile(c1)
quantile(c1)[4] - quantile(c1)[2]

```

Вывести комплексную статистику по переменной (summary).  
```{r}
summary(c1)
```

Вычислить дисперсию (var) для переменных с1 и  c1*2+100 в указанном порядке и сравнить результаты.  
```{r}
var(c1)
var(c1*2+100)
```
**Вторая дисперсия больше в четыре раза.**
Построить гистограмму (hist).   
```{r}
hist(c1)
```

Вывести асимметрию(skewness) и эксцесс (kurtosis) в указанном порядке.    
```{r}
skewness(c1)
kurtosis(c1)
```

Проверить нормальность остатков с помощью статистического теста Лиллиефорса (lillie.test - Раздел 2).  
```{r}
library(nortest)
lillie.test(c1)
```

# Задание 3. Анализ статистических зависимостей

Перекодировать переменную kit так, чтобы она принимала только два значения: 1 и 2 (1 при kit<3, 2 - иначе).
```{r}
qc$kit <- ifelse(qc$kit<3,1,2)
```

Вычислить ранговый коэффициент корреляции Спирмена (cor,method="spearman") для переменных kit и maker. 
```{r}
cor(qc$kit,qc$maker)
```

Вывести таблицу сопряженности (table) по переменным kit и maker.  
```{r}
table(qc$kit, qc$maker)
```

Для переменных с1,с3 вычислить коэффициент корреляции с проверкой статистической значимости (cor.test).   
```{r}
cor.test(qc$c1, qc$c3, method="pearson")
```

Вывести корреляционную матрицу по всем числовым характеристикам с1-c4 (cor). Для выбора нужных столбцов таблицы воспользоваться оператором "[]" (выбирается сразу несколько столбцов, последовательность индексов задается с помощью функции c - Раздел 1, таблицы данных).     
Между какими переменными есть значимая корреляция? **Значимая корреляция наблюдается между меременными c1 и c2.**
```{r}
cor(qc[c('c1','c2','c3','c4')])
```

Представить матрицу корреляции в более удобном виде(symnum, в качестве аргумента данной функции использовать результат функции cor).    
```{r}
symnum(cor(qc[c('c1','c2','c3','c4')]),diag = FALSE)
```

Построить модель линейной регрессии для пары переменных, для которых коэффициент корреляции имеет наибольшее значение. Использовать функцию lm, зависимая переменная - с меньшим номером. Полученную модель сохранить в переменную linmod.   
Вывести общую статистику по модели (summary).   

```{r}
linmod <- lm(formula = c1~c2)
summary(linmod)
```

Построить диаграмму рассеяния (plot) с линией регрессии (abline) для переменных, которые участвуют в оцененной модели.
```{r}
plot(qc$c2, qc$c1, pch = 16, cex = 1.3, col = "blue", xlab = "c1", ylab = "c2")
abline(linmod,col="red",lwd=4)
```

Вывести отдельно коэффициенты модели (coefficients).   
```{r}
linmod$coefficients
```

Сохранить значения остатков (residuals) модели linmod в переменную res. Построить график "Квантиль-квантиль" (qqnorm) для остатков.
```{r}
res = linmod$residuals
qqnorm(res)
```

Проверить нормальность остатков с помощью статистического теста Колмогорова-Смирнова (ks.test - Раздел 2).  
```{r}
m=mean(res); s=sd(res)
ks.test(res,pnorm,mean=m,sd=s)
```


# Задание 4. Анализ неоднородных данных

Подсчитать частоты значений для переменной maker (table).  
```{r}
table(qc$maker)
```

Последовательно применить двухвыборочный t-критерий (t.test) к переменным c1,c2,c3,с4. Ввборки значений каждой переменной разделяются на две подвыборки  по значениям переменной maker (1 или 2).   
Вывести результаты (статистику по тесту) для той переменной (одной из c1,c2,c3,с4), для которой наблюдается значимое (на уровне 0.05) различие средних в двух подвыборках (значение p-value близко к нулю).     
Далее анализировать только выбранную переменную.  

```{r}
#t.test(qc$c1[qc$maker==1],qc$c1[qc$maker==2])
#t.test(qc$c2[qc$maker==1],qc$c2[qc$maker==2])
#t.test(qc$c3[qc$maker==1],qc$c3[qc$maker==2])
t.test(qc$c4[qc$maker==1],qc$c4[qc$maker==2])
```

Построить "ящики с усами" для анализируемой переменной в разрезе по номеру производителя (maker).
```{r}
boxplot(qc$c4~qc$maker)
```

Построить график ядерной оценки плотности распределения (density) для анализируемой переменной.  
```{r}
plot(density(qc$c4))
```

# Задание 5. Классификация неоднородных данных

Построить диаграмму рассеяния (plot) для двух переменных, которые имеют наименьшую корреляцию (см. матрицу корреляции).  
```{r}
plot(qc$c3~qc$c4)
```

Объединить выбранные переменные в одну матрицу (cbind) и сохранить ее в новую переменную. Вывести первые три строки полученной матрицы (head).  
```{r}
cnew = cbind(qc$c3,qc$c4)
head(cnew,3)
```

Выполнить кластерный анализ (kmeans) с разбиением на два класса в пространстве выбранных переменных (kmeans). В качестве первого аргумента функции kmeans необходимо передавать матрицу, а второго - количество классов (2), на которое производится разбиение.   
Сохранить результаты в переменную kmres и вывести частоты наблюдений в каждом оцененном классе (table).
```{r}
kmres = kmeans(cnew,2)
table(kmres$cluster)
```

Вывести график (plot) с легендой (legend), на котором должна быть обозначена классовая принадлежность каждого наблюдения различными символами (параметр pch).   
```{r}
plot(qc$c3~qc$c4, pch=kmres$cluster)
legend("topright", c("1","2"), pch=c(1,2), title= "Legend")
```

Отсоединить таблицу данных qc от списка текущих переменных (работа с данными закончена).

```{r}
detach(qc)
```
